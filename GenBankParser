/*
Author: Faith Igomodu 
Date: 10/22/2025
File: GenBankParser.java
Description: GenBank File Parser Developed With BioJava 7.2.2
*/
____________________________________________________________________________________________________________________________________


import java.io.*;
import org.biojava.nbio.core.sequence.DNASequence;
import org.biojava.nbio.core.sequence.compound.AmbiguityDNACompoundSet;
import org.biojava.nbio.core.sequence.compound.AmbiguityRNACompoundSet;
import org.biojava.nbio.core.sequence.compound.NucleotideCompound;
import org.biojava.nbio.core.sequence.io.*;
import org.biojava.nbio.core.sequence.template.CompoundSet;
import java.util.Map;


public class GenBankParser {

    public static void main(String[] args) throws Exception {

        //BufferedReader object to read input from console
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        // Prompt user for full file path of GenBank file
        System.out.print("Enter the full path of the GenBank file: ");
        String fullPath = br.readLine();
        //File object of GenBank file
        File genFile = new File(fullPath);
        //Try-catch statement to ensure InputStream is closed automatically
        try (InputStream inputStream = new FileInputStream(genFile)) {
            // Display the name of the file
            System.out.println("File Name: " + genFile.getName());

            // Check if file exists
            if (genFile.exists()) {
                //Create sets for ambigugous DNA and RNA sequences
                AmbiguityDNACompoundSet ambiguityDNACompoundSet = AmbiguityDNACompoundSet.getDNACompoundSet();
                CompoundSet<NucleotideCompound> nucleotideCompoundSet = AmbiguityRNACompoundSet.getRNACompoundSet();
                //GenbankReader object to parse GenBank file
                GenbankReader<DNASequence, NucleotideCompound> proxy =
                        new GenbankReader<>(
                                inputStream,
                                new GenericGenbankHeaderParser<DNASequence, NucleotideCompound>(),
                                new DNASequenceCreator(ambiguityDNACompoundSet));
                //Process the GenBank file and retrieve sequences
                Map<String, DNASequence> genSequence = proxy.process();
                //Display Number of sequences found
                if (!genSequence.isEmpty()) {
                    System.out.println("\n--- Found " + genSequence.size() + " Sequences ---");
                    //Iterate over the map of sequences
                    int count = 1;
                    for (Map.Entry<String, DNASequence> entry : genSequence.entrySet()) {
                        DNASequence dnaSeq = entry.getValue();
                        //Display accession ID
                        System.out.println("Sequence #" + count + " (Accession ID: " + entry.getKey() + ")");
                        // Display GenBank Description / Definition
                        System.out.println("GenBank Description: " + dnaSeq.getDescription());
                        // Display the sequence length
                        System.out.println("Sequence Length: " + dnaSeq.getLength());
                        // Display the sequence
                        System.out.println("Sequence: " +
                                dnaSeq.getSequenceAsString() +"\n");
                        count++;
                   }

                } else {
                    //Message if the  GenBank file is empty
                    System.out.println("GenBank file is empty. Try again.");
                }

            } else {
                //Message if the file does not exist
                System.out.println("File does not exist. Try again.");
            }

        } catch (Exception e) {
            //Handle exceptions
            e.printStackTrace();
        }
    }






